!function(){var h,n,f,v,A=function(a){var b=a;return{get:function(){return b},set:function(a){b=a},clone:function(){return A(b)}}},I=tinymce.util.Tools.resolve("tinymce.PluginManager"),J=function(a){return{isEnabled:function(){return a.get()}}},p={"\u00a0":"nbsp","\u00ad":"shy"},k=function(a,b){var c,d="";for(c in a)d+=c;return new RegExp("["+d+"]",b?"g":"")},K=k(p),L=k(p,!0),M=function(a){var b,c="";for(b in a)c&&(c+=","),c+="span.mce-"+a[b];return c}(p),k=function(a){return function(){return a}},
q={noop:function(){},noarg:function(a){return function(){return a()}},compose:function(a,b){return function(){return a(b.apply(null,arguments))}},constant:k,identity:function(a){return a},tripleEquals:function(a,b){return a===b},curry:function(a){for(var b=Array(arguments.length-1),c=1;c<arguments.length;c++)b[c-1]=arguments[c];return function(){for(var c=Array(arguments.length),e=0;e<c.length;e++)c[e]=arguments[e];c=b.concat(c);return a.apply(null,c)}},not:function(a){return function(){return!a.apply(null,
arguments)}},die:function(a){return function(){throw Error(a);}},apply:function(a){return a()},call:function(a){a()},never:k(!1),always:k(!0)},l=q.never,w=q.always,g=function(){return x},x=(v={fold:function(a,b){return a()},is:l,isSome:l,isNone:w,getOr:f=function(a){return a},getOrThunk:n=function(a){return a()},getOrDie:function(a){throw Error(a||"error: getOrDie called on none.");},or:f,orThunk:n,map:g,ap:g,each:function(){},bind:g,flatten:g,exists:l,forall:w,filter:g,equals:h=function(a){return a.isNone()},
equals_:h,toArray:function(){return[]},toString:q.constant("none()")},Object.freeze&&Object.freeze(v),v),r=function(a){var b=function(){return a},c=function(){return e},d=function(b){return b(a)},e={fold:function(b,c){return c(a)},is:function(b){return a===b},isSome:w,isNone:l,getOr:b,getOrThunk:b,getOrDie:b,or:c,orThunk:c,map:function(b){return r(b(a))},ap:function(b){return b.fold(g,function(b){return r(b(a))})},each:function(b){b(a)},bind:d,flatten:b,exists:d,forall:d,filter:function(b){return b(a)?
e:x},equals:function(b){return b.is(a)},equals_:function(b,c){return b.fold(l,function(b){return c(a,b)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return e},N={some:r,none:g,from:function(a){return null===a||void 0===a?x:r(a)}};h=(Array.prototype.indexOf,void 0,function(a,b){for(var c=a.length,d=Array(c),e=0;e<c;e++)d[e]=b(a[e],e,a);return d});var O=(Array.prototype.push,Array.prototype.slice,h),y=function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c,a)},m=function(a){if(null===
a||void 0===a)throw Error("Node cannot be null or undefined");return{dom:q.constant(a)}},B={fromHtml:function(a,b){b=(b||document).createElement("div");if(b.innerHTML=a,!b.hasChildNodes()||1<b.childNodes.length)throw console.error("HTML does not have a single root node",a),"HTML must have a single root node";return m(b.childNodes[0])},fromTag:function(a,b){a=(b||document).createElement(a);return m(a)},fromText:function(a,b){a=(b||document).createTextNode(a);return m(a)},fromDom:m,fromPoint:function(a,
b,c){return N.from(a.dom().elementFromPoint(b,c)).map(m)}},C=function(a){return a.dom().nodeName.toLowerCase()},z=function(a){return a.dom().nodeType};f=function(a){return function(b){return z(b)===a}};h=f(1);n=f(3);f=f(9);var t={name:C,type:z,value:function(a){return a.dom().nodeValue},isElement:h,isText:n,isDocument:f,isComment:function(a){return 8===z(a)||"#comment"===C(a)}},P=function(a){return'<span data-mce-bogus="1" class="mce-'+p[a]+'">'+a+"</span>"},D=function(a,b){var c=[];a=a.dom();a=O(a.childNodes,
B.fromDom);return y(a,function(a){b(a)&&(c=c.concat([a]));c=c.concat(D(a,b))}),c},u={isMatch:function(a){return t.isText(a)&&void 0!==t.value(a)&&K.test(t.value(a))},filterDescendants:D,findParentElm:function(a,b){for(;a.parentNode;){if(a.parentNode===b)return a;a=a.parentNode}},replaceWithSpans:function(a){return a.replace(L,P)}},E=function(a,b){var c,d;b=u.filterDescendants(B.fromDom(b),u.isMatch);y(b,function(b){var e=u.replaceWithSpans(t.value(b));for(d=a.dom.create("div",null,e);c=d.lastChild;)a.dom.insertAfter(c,
b.dom());a.dom.remove(b.dom())})},F=function(a,b){b=a.dom.select(M,b);y(b,function(b){a.dom.remove(b,1)})},G=function(a){var b=a.getBody(),c=a.selection.getBookmark(),d=u.findParentElm(a.selection.getNode(),b),d=void 0!==d?d:b;F(a,d);E(a,d);a.selection.moveToBookmark(c)},Q=function(a,b){a.addCommand("mceVisualChars",function(){var c,d=a.getBody(),e=a.selection;b.set(!b.get());c=b.get();a.fire("VisualChars",{state:c});c=e.getBookmark();!0===b.get()?E(a,d):F(a,d);e.moveToBookmark(c)})},R=tinymce.util.Tools.resolve("tinymce.util.Delay"),
S=function(a,b){var c=R.debounce(function(){G(a)},300);!1!==a.settings.forced_root_block&&a.on("keydown",function(d){!0===b.get()&&(13===d.keyCode?G(a):c())})},H=function(a){return function(b){var c=b.control;a.on("VisualChars",function(a){c.active(a.state)})}};I.add("visualchars",function(a){var b=A(!1);return Q(a,b),a.addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:H(a)}),a.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",
onPostRender:H(a),selectable:!0,context:"view",prependToContext:!0}),S(a,b),J(b)})}();
