!function(){var f=function(a){var b=a.selection.getNode();return"A"===b.tagName&&""===a.dom.getAttrib(b,"href")?b.id||b.name:""},g=function(a){var b=f(a);a.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:b},onsubmit:function(b){var c=b.data.id;if(/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(c)){var d=a.selection.getNode();"A"===d.tagName&&""===a.dom.getAttrib(d,"href")?(d.removeAttribute("name"),d.id=c):(a.focus(),a.selection.collapse(!0),a.execCommand("mceInsertContent",
!1,a.dom.createHTML("a",{id:c})));c=0}else c=(a.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."),1);c&&b.preventDefault()}})},h=function(a){a.addCommand("mceAnchor",function(){g(a)})},e=function(a){return function(b){for(var d=0;d<b.length;d++)(c=b[d]).attr("href")||!c.attr("id")&&!c.attr("name")||c.firstChild||b[d].attr("contenteditable",a);var c}},k=function(a){a.on("PreInit",function(){a.parser.addNodeFilter("a",e("false"));
a.serializer.addNodeFilter("a",e(null))})};tinymce.util.Tools.resolve("tinymce.PluginManager").add("anchor",function(a){k(a);h(a);a.addButton("anchor",{icon:"anchor",tooltip:"Anchor",cmd:"mceAnchor",stateSelector:"a:not([href])"});a.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",cmd:"mceAnchor"})})}();
