function validateCompleteForm(a,b){return _validateInternal(a,b,0)}function validateStandard(a,b){return _validateInternal(a,b,1)}function _validateInternal(a,b,c){var d="",e=null;0==c&&(d=a.err?a.err:_getLanguageText("err_form"));a=_GenerateFormFields(a);for(var g=0;g<a.length;++g){var f=a[g];if(f.IsValid(a))f.ResetClass();else{f.SetClass(b);if(1==c)return _throwError(f),!1;null==e&&(e=f);d=_handleError(f,d);bError=!0}}return null!=e?(alert(d),e.element.focus(),!1):!0}
function _getLanguageText(a){objTextsInternal=new _jsVal_Language;objTexts=null;try{objTexts=new jsVal_Language}catch(b){}switch(a){case "err_form":strResult=objTexts&&objTexts.err_form?objTexts.err_form:objTextsInternal.err_form;break;case "err_enter":strResult=objTexts&&objTexts.err_enter?objTexts.err_enter:objTextsInternal.err_enter;break;case "err_select":strResult=objTexts&&objTexts.err_select?objTexts.err_select:objTextsInternal.err_select}return strResult}
function _GenerateFormFields(a){for(var b=[],c=0;c<a.length;++c){var d=a.elements[c],e=_getElementIndex(b,d);-1==e?b[b.length]=new Field(d,a):b[e].Merge(d)}return b}function _getElementIndex(a,b){if(b.name)for(var c=b.name.toLowerCase(),d=0;d<a.length;++d)if(a[d].element.name&&a[d].element.name.toLowerCase()==c)return d;return-1}
function _jsVal_Language(){this.err_form="Please enter/select values for the following fields:\n\n";this.err_select='Please select a valid "%FIELDNAME%"';this.err_enter='Please enter a valid "%FIELDNAME%"'}
function Field(a,b){this.type=a.type;this.element=a;this.exclude=a.exclude||a.getAttribute("exclude");this.err=a.err||a.getAttribute("err");this.required=_parseBoolean(a.required||a.getAttribute("required"));this.realname=a.realname||a.getAttribute("realname");this.elements=[];switch(this.type){case "textarea":case "password":case "text":case "file":this.value=a.value;this.minLength=a.minlength||a.getAttribute("minlength");this.maxLength=a.maxlength||a.getAttribute("maxlength");this.regexp=this._getRegEx(a);
this.minValue=a.minvalue||a.getAttribute("minvalue");this.maxValue=a.maxvalue||a.getAttribute("maxvalue");this.equals=a.equals||a.getAttribute("equals");this.callback=a.callback||a.getAttribute("callback");break;case "select-one":case "select-multiple":this.values=[];for(var c=0;c<a.options.length;++c)!a.options[c].selected||this.exclude&&a.options[c].value==this.exclude||(this.values[this.values.length]=a.options[c].value);this.min=a.min||a.getAttribute("min");this.max=a.max||a.getAttribute("max");
this.equals=a.equals||a.getAttribute("equals");break;case "checkbox":this.min=a.min||a.getAttribute("min"),this.max=a.max||a.getAttribute("max");case "radio":this.required=_parseBoolean(this.required||a.getAttribute("required")),this.values=[],a.checked&&(this.values[0]=a.value),this.elements[0]=a}}
Field.prototype.Merge=function(a){_parseBoolean(a.getAttribute("required"))&&(this.required=!0);this.err||(this.err=a.getAttribute("err"));this.equals||(this.equals=a.getAttribute("equals"));this.callback||(this.callback=a.getAttribute("callback"));this.realname||(this.realname=a.getAttribute("realname"));this.max||(this.max=a.getAttribute("max"));this.min||(this.min=a.getAttribute("min"));this.regexp||(this.regexp=this._getRegEx(a));a.checked&&(this.values[this.values.length]=a.value);this.elements[this.elements.length]=
a};Field.prototype.IsValid=function(a){switch(this.type){case "textarea":case "password":case "text":case "file":return this._ValidateText(a);case "select-one":case "select-multiple":case "radio":case "checkbox":return this._ValidateGroup(a);default:return!0}};
Field.prototype.SetClass=function(a){if(a&&""!=a)if(this.elements&&0<this.elements.length)for(var b=0;b<this.elements.length;++b)this.elements[b].className!=a&&(this.elements[b].oldClassName=this.elements[b].className,this.elements[b].className=a);else this.element.className!=a&&(this.element.oldClassName=this.element.className,this.element.className=a)};
Field.prototype.ResetClass=function(){if("button"!=this.type&&"submit"!=this.type&&"reset"!=this.type)if(this.elements&&0<this.elements.length)for(var a=0;a<this.elements.length;++a)this.elements[a].oldClassName?this.elements[a].className=this.elements[a].oldClassName:this.element.className="";else this.element.className=this.elements.oldClassName?this.element.oldClassName:""};
Field.prototype._getRegEx=function(a){regex=a.regexp||a.getAttribute("regexp");if(null==regex)return null;retype=typeof regex;return"FUNCTION"==retype.toUpperCase()?regex:"STRING"==retype.toUpperCase()&&"JSVAL_RX_EMAIL"!=regex&&"JSVAL_RX_TEL"!=regex&&"JSVAL_RX_PC"!=regex&&"JSVAL_RX_ZIP"!=regex&&"JSVAL_RX_MONEY"!=regex&&"JSVAL_RX_CREDITCARD"!=regex&&"JSVAL_RX_POSTALZIP"!=regex?(nEnd=nBegin=0,"/"==regex.charAt(0)&&(nBegin=1),"/"==regex.charAt(regex.length-1)&&(nEnd=0),new RegExp(regex.slice(nBegin,
nEnd))):regex};
Field.prototype._ValidateText=function(a){if(this.required&&this.callback){if(nCurId=this.element.id?this.element.id:"",nCurName=this.element.name?this.element.name:"",eval("bResult = "+this.callback+"('"+nCurId+"', '"+nCurName+"', '"+this.value+"');"),0==bResult)return!1}else{if(this.required&&!this.value||this.value&&this.minLength&&this.value.length<this.minLength||this.value&&this.maxLength&&this.value.length>this.maxLength)return!1;if(this.regexp){if(_checkRegExp(this.regexp,this.value))return!0;if(!this.required&&
this.value||this.required)return!1}if(this.equals)for(var b=0;b<a.length;++b){var c=a[b];if(c.element.name==this.equals||c.element.id==this.equals){if(c.element.value!=this.value)return!1;break}}if(this.required&&(a=parseFloat(this.value),(this.minValue||this.maxValue)&&isNaN(a)||this.minValue&&a<this.minValue||this.maxValue&&a>this.maxValue))return!1}return!0};
Field.prototype._ValidateGroup=function(a){return this.required&&0==this.values.length||this.required&&this.min&&this.min>this.values.length||this.required&&this.max&&this.max<this.values.length?!1:!0};function _handleError(a,b){var c=a.element;return strNewMessage=b+(a.realname?a.realname:c.id?c.id:c.name)+"\n"}
function _throwError(a){var b=a.element;switch(a.type){case "text":case "password":case "textarea":case "file":alert(_getError(a,"err_enter"));try{b.focus()}catch(c){}break;case "select-one":case "select-multiple":case "radio":case "checkbox":alert(_getError(a,"err_select"))}}
function _getError(a,b){var c=a.element;strErrorTemp=a.err?a.err:_getLanguageText(b);for(idx=strErrorTemp.indexOf("\\n");-1<idx;)strErrorTemp=strErrorTemp.replace("\\n","\n"),idx=strErrorTemp.indexOf("\\n");return strErrorTemp.replace("%FIELDNAME%",a.realname?a.realname:c.id?c.id:c.name)}function _parseBoolean(a){return!(!a||0==a||"0"==a||"false"==a)}
function _checkRegExp(a,b){switch(a){case "JSVAL_RX_EMAIL":return/^[a-zA-Z]+([\.-]?[a-zA-Z]+)*@[a-zA-Z]+([\.-]?[a-zA-Z]+)*(\.\w{2,5})+$/.test(b);case "JSVAL_RX_TEL":return/^1?[\- ]?\(?\d{3}\)?[\- ]?\d{3}[\- ]?\d{4}$/.test(b);case "JSVAL_RX_PC":return/^[a-z]\d[a-z] ?\d[a-z]\d$/i.test(b);case "JSVAL_RX_ZIP":return/^\d{5}$/.test(b);case "JSVAL_RX_MONEY":return/^\d+([\.]\d\d)?$/.test(b);case "JSVAL_RX_CREDITCARD":return!isNaN(b);case "JSVAL_RX_POSTALZIP":if(6==b.length||7==b.length)return/^[a-zA-Z]\d[a-zA-Z] ?\d[a-zA-Z]\d$/.test(b);
if(5==b.length||10==b.length)return/^\d{5}(\-\d{4})?$/.test(b);break;default:return a.test(b)}};
